{% extends 'base.html' %}
{% block content %}
<div class="flex items-center justify-between mb-4">
  <h1 class="text-2xl font-semibold">Jails</h1>
  <form method="post" action="{{ url_for('reload_all') }}" onsubmit="return confirm('Recharger Fail2ban (tous les jails) ?');">
    <button type="submit" class="px-3 py-2 rounded bg-blue-600 text-white text-sm">Recharger tout</button>
  </form>
</div>
{% if jails %}
<ul class="divide-y divide-gray-700 rounded border border-gray-700">
  {% for jail in jails %}
  <li class="p-3">
    <div class="flex items-center justify-between">
      <a href="{{ url_for('jail_detail', jail=jail) }}" class="font-semibold text-blue-400 hover:underline">{{ jail }}</a>
      <div></div>
    </div>
    {% set m = metrics.get(jail, {}) %}
    <div class="text-sm mt-2 text-gray-300 space-x-4">
      {% if m.error %}
        <span class="text-red-400">Erreur: {{ m.error }}</span>
      {% else %}
        <span>Currently failed: <span class="font-semibold text-white">{{ m.currently_failed }}</span></span>
        <span>Total failed: <span class="font-semibold text-white">{{ m.total_failed }}</span></span>
        <span>Currently banned: <span class="font-semibold text-white">{{ m.currently_banned }}</span></span>
        <span>Total banned: <span class="font-semibold text-white">{{ m.total_banned }}</span></span>
      {% endif %}
    </div>
  </li>
  {% endfor %}
</ul>
{% else %}
<p class="text-gray-300">Aucun jail trouvÃ©.</p>
{% endif %}
{% endblock %}
